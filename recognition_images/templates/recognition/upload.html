{% extends "base.html" %}
{% load static %}

{% block title %}–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ | –≠–õ–ö–û–ú{% endblock %}

{% block content %}
<div class="upload-container">
    <form method="post" enctype="multipart/form-data" class="upload-form">
        {% csrf_token %}
        <div class="drop-area" id="dropArea" tabindex="0">
            {{ form.file }}
            <div class="drop-text">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞</p>
                <p class="formats">–§–æ—Ä–º–∞—Ç: .png, .jpg, .jpeg, .pdf</p>
            </div>
            <div class="processing-indicator">
                <div class="spinner"></div>
                {% comment %} <p>–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...</p> {% endcomment %}
            </div>
        </div>
        <button type="submit" class="btn-upload">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    </form>
    
<div id="pdfModal" class="modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PDF</h3>
        <div class="modal-scroll-container">
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º–∏–Ω–∏–∞—Ç—é—Ä —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º -->
        <div class="thumbnails-scroll-container">
            <div id="pageThumbnails" class="page-thumbnails"></div>
        </div>
        
        <div class="pdf-main-container">
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
            <div class="pdf-viewer-container">
                <div id="pdfPreview" class="pdf-viewer">
                    <!-- PDF –±—É–¥–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </div>
                
                <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ–¥ –æ–±–ª–∞—Å—Ç—å—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
                <div class="pdf-toolbar">
                    <div class="toolbar-group">
                        <button id="rotateLeft" class="tool-btn">
                            <i class="rotate-icon">‚Üª</i> –ü–æ–≤–µ—Ä–Ω—É—Ç—å
                        </button>
                        {% comment %} <button id="resetSelection" class="tool-btn">
                            <i class="reset-icon">‚Ü∫</i> –°–±—Ä–æ—Å–∏—Ç—å
                        </button>  {% endcomment %}
                    </div>
                    <div class="page-counter" id="pageCounter">
                        <span class="pages-total">–°—Ç—Ä–∞–Ω–∏—Ü—ã (1)</span>
                        <span class="page-separator">|</span>
                        <span class="current-page">–°—Ç—Ä. 1</span>
                    </div>
                </div>
            </div>
            
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ -->
            <div class="pdf-sidebar">
                <div class="sidebar-section">
                    <h4 class="section-title">–î–µ–π—Å—Ç–≤–∏—è</h4>
                    <div class="pdf-actions">
                        <button id="convertFullPage" class="action-btn primary">
                            <i class="send-icon">ü°¢</i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                        </button>
                        {% comment %} <button id="convertSelection" class="action-btn secondary">
                            <i class="select-icon">‚ñ¶</i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ
                        </button> {% endcomment %}
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h4 class="section-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                    <div class="format-selector">
                        <label for="outputFormat" class="format-label">–§–æ—Ä–º–∞—Ç:</label>
                        <select id="outputFormat" class="format-select">
                            <option value="png">PNG</option>
                            <option value="jpg">JPG</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
</div>

    {% if error %}
    <div class="error-message">
        {{ error }}
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script>
    // –ü–µ—Ä–µ–¥–∞–µ–º URL –∏–∑ Django –≤ JavaScript
    const PROCESS_PDF_URL = "{% url 'process_pdf' %}";
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>  
<script type="module" src="{% static 'js/main.js' %}"></script>
{% endblock %}